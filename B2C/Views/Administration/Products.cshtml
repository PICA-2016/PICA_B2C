
@{
    ViewBag.Title = "Productos";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="row">
    <div class="col-lg-12">
        <h1 class="page-header">Productos</h1>
    </div>
    <!-- /.col-lg-12 -->
</div>
<!-- /.row -->
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <!-- /.panel-heading -->
            <div class="panel-body">
                <div class="demo-section k-content">
                    <input type="radio" value="Code" name="search" data-bind="checked: selectedSearch" class="k-radio" checked="checked">
                    <label class="k-radio-label" for="search2">Código de Producto</label>

                    <input type="radio" value="Name" name="search" data-bind="checked: selectedSearch" class="k-radio">
                    <label class="k-radio-label" for="search3">Nombre de Producto</label>

                    <input type="radio" value="Description" name="search" data-bind="checked: selectedSearch" class="k-radio">
                    <label class="k-radio-label" for="search4">Descripción de Producto</label>
                </div>

                <div class="dataTable_wrapper">
                    <table class="table table-striped table-bordered table-hover" id="productsTable">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Imagen</th>
                                <th>Precio</th>
                                <th>Detalle</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="odd gradeA">
                                <td></td>
                                <td class="center"></td>
                                <td></td>
                                <td class="center"></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

@section css {
    @Styles.Render("~/css/dataTables")
}
@section scripts {
    @Scripts.Render("~/bundles/dataTables"),
    @Scripts.Render("~/bundles/dataTables_bootstrap"),
    @*@Scripts.Render("~/bundles/table")*@

    @*<script src="~/Scripts/DataTables/jquery.dataTables.js"></script>*@
    <script src="~/bower_components/datatables/media/js/jquery.dataTables.js"></script>

    <script type="text/javascript">
        var productsTable;
        $(document).ready(function () {
            //Table Products
            productsTable = $('#productsTable').DataTable({
                "responsive": true,
                "processing": true,
                "serverSide": true,
                @*"language": {
                    "url": "@Url.Action("DatatablesLocalizacion")"
                },*@
                "ajax": {
                    "url": "@Url.Action("FilterProducts", new { typeSearch = "-typeSearch-" })",
                    "error": errorTable,
                    "beforeSend": function (jqXHR, settings) {
                        settings.url = settings.url.replace('-typeSearch-', $('input[name=search]:checked').val());
                    }
                },
                columns: [
                     { data: 'Name' },
                     { data: 'Image' },
                     { data: 'ListPrice' },
                     {
                         "targets": -1,
                         "data": null,

                         "defaultContent": "<button onclick='ProductDetail(this)'><img src='../../Content/Images/ViewDetail.png'/></button>"
                     }
                ],
                "columnDefs": [
                {
                    "render": function (data, type, row) {
                        var ruta = "<img src=@Url.Content("-file-") style=' height: 80px;' >";
                        return ruta.replace("-file-", row.Image);
                    },
                    "targets": 1
                }
                ]
            });
        });

        //Detail Product
        function ProductDetail(e) {
            var dataRow = productsTable.row($(e).parents('tr')).data();

            window.location.href = '@Url.Action("ProductDetail", new { id = "-id-" })'.replace('-id-', dataRow.ProductId);
        }

        ////Complete Detail
        //function CompleteDetail(menssaje) {
        //    $('#detailModal').modal('hide');
        //    productsTable.ajax.reload();
        //    if (menssaje != null && menssaje != '') {
        //        document.getElementById("resultMessage").innerHTML = menssaje;
        //        $("#resultMessageContainer").removeClass('hidden');
        //    }
        //}

        //Error
        function error() {
            $('#resultMessage').text("Connection error");
            $('#resultMessageContainer').removeClass('hidden');
        }

        //Error table
        function errorTable() {
            $('#resultMessage').text("They will not be see data");
            $('#resultMessageContainer').removeClass('hidden');
        }

        //Clean validation control
        function CleanValidations() {
            $('#validationMessage').empty();
        }

    </script>
}

